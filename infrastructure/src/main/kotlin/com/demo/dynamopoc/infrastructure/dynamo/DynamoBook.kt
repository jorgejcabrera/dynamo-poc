package com.demo.dynamopoc.infrastructure.dynamo

import com.amazonaws.services.dynamodbv2.datamodeling.*
import com.demo.dynamopoc.core.book.Book
import java.util.*

@DynamoDBTable(tableName = "Book")
class DynamoBook : Book {
    // Partition key
    @get:DynamoDBHashKey(attributeName = "country")
    override val group: String?

    // Local secondary index
    @get:DynamoDBAttribute(attributeName = "title")
    @DynamoDBIndexRangeKey(localSecondaryIndexName = "title_idx")
    override val title: String?

    // Sorting key
    @get:DynamoDBAttribute(attributeName = "created_date")
    @DynamoDBAutoGeneratedTimestamp(strategy = DynamoDBAutoGenerateStrategy.CREATE)
    @DynamoDBRangeKey
    override val createdDate: Date?

    @get:DynamoDBAttribute(attributeName = "price")
    override val price: Double?

    @get:DynamoDBAttribute(attributeName = "rating")
    override val rating: Int?

    constructor() {
        this.title = null
        this.price = null
        this.rating = null
        this.group = null
        this.createdDate = null
    }

    constructor(title: String, group: String, createdDate: Date, price: Double, rating: Int) {
        this.title = title
        this.price = price
        this.rating = rating
        this.group = group
        this.createdDate = createdDate
    }
}